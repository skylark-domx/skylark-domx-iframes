{"version":3,"sources":["replace.js"],"names":["define","getQuery","noder","geom","styler","iframes","loadReal","replace","link","options","iframe","createElement","className","id","style","border","url","href","size","search","holdingUrl","css","width","height","inview","lazyLoad"],"mappings":";;;;;;;AAAAA,QACE,8BACA,qBACA,oBACA,sBACA,YACA,cACA,eACA,SAASC,EAASC,EAAMC,EAAKC,EAAOC,EAAQC,GAC5C,aA0CA,OAAOD,EAAQE,QAxCf,SAAiBC,EAAKC,GACpBA,EAAUA,MAEV,IAAIC,EAASR,EAAMS,cAAc,UAC/BC,UAAcJ,EAAKI,UACnBC,GAAOL,EAAKK,GACZC,OAAYC,OAAW,oBAGrBC,EAAMP,EAAQO,KAAOR,EAAKS,KAC1BC,EAAOT,EAAQS,MAAQjB,EAASO,EAAKW,QACrCC,EAAaX,EAAQW,WAEzBhB,EAAOiB,IAAIX,EAAO,QAASQ,EAAKI,OAAS,QACzClB,EAAOiB,IAAIX,EAAO,YAAaQ,EAAKK,QAAU,SAC1CL,EAAKK,QACPnB,EAAOiB,IAAIX,EAAO,YAAaQ,EAAKK,QAIlCpB,EAAKqB,OAAOhB,EAAM,KAKpBF,EAASI,GAAQM,IAAAA,IAKjBS,SAASf,GACPM,IAAAA,EACAI,WAAAA,IAKJlB,EAAMK,QAAQG,EAAQF","file":"../replace.js","sourcesContent":["define([\r\n  \"skylark-langx-urls/getQuery\",\r\n  \"skylark-domx-noder\",\r\n  \"skylark-domx-geom\",\r\n  \"skylark-domx-styler\",\r\n  \"./iframes\",\r\n  \"./load-real\",\r\n  \"./lazy-load\"\r\n],function(getQuery,noder,geom,styler,iframes,loadReal){\r\n  'use strict';\r\n  \r\n  function replace(link,options) {\r\n    options = options || {};\r\n\r\n    var iframe = noder.createElement('iframe',{\r\n      \"className\" : link.className, // inherit all the classes from the link\r\n      \"id\" : link.id, // also inherit, giving more style control to the user\r\n      \"style\" : { \"border\" : '1px solid #aaa'}\r\n    });\r\n    ///var url = link.href.replace(/edit/, 'embed');\r\n    var url = options.url || link.href,\r\n        size = options.size || getQuery(link.search),\r\n        holdingUrl = options.holdingUrl;\r\n\r\n    styler.css(iframe,\"width\", size.width || '100%');\r\n    styler.css(iframe,\"minHeight\", size.height || '300px');\r\n    if (size.height) {\r\n      styler.css(iframe,\"maxHeight\", size.height);\r\n    }\r\n\r\n    // track when it comes into view and reload\r\n    if (geom.inview(link, 100)) {\r\n      // the iframe is full view, let's render it\r\n      ///iframe.src = url.split('&')[0];\r\n      ///iframe._src = url.split('&')[0]; // support for google slide embed\r\n      ///hookMessaging(iframe);\r\n      loadReal(iframe,{url})\r\n    } else {\r\n      ///iframe.setAttribute('data-url', url);\r\n      ///iframe.src = 'https://jsbin.com/embed-holding';\r\n      ///pending.push(iframe);\r\n      lazyLoad(iframe,{\r\n        url,\r\n        holdingUrl\r\n      });\r\n\r\n    }\r\n\r\n    noder.replace(iframe, link);\r\n  }\r\n\r\n  return iframes.replace = replace;\r\n});"]}